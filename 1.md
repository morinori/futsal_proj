# Streamlit Cold Start 최적화 - 첫 페이지 로딩 성능 개선

## 현재 상황 분석

### 문제점
- 모든 페이지가 `app.py`에서 upfront로 import됨 (14개 페이지 + 모든 dependencies)
- 첫 페이지를 보기 전에 모든 페이지와 서비스가 로드됨
- 사용자가 실제로 접근하지 않는 페이지도 초기에 로드

### 현재 Import 구조
```python
from ui.pages import (
    dashboard_page,
    schedule_page,
    players_page,
    statistics_page,
    attendance_page,
    news_page,
    gallery_page,
    finance_page,
    admin_settings,
    video_upload,
    video_gallery,
    news_management,
    video_logs,
    team_builder
)
```

## 솔루션 옵션

### Option 1: Lazy Loading (권장)
**개요**: 페이지를 사용자가 탐색할 때만 동적으로 로드

**장점:**
- 가장 빠른 초기 로드
- 필요한 것만 로드
- 페이지 추가 시 확장성 우수

**단점:**
- 각 페이지 첫 탐색 시 약간의 지연
- 페이지 import 리팩토링 필요

**구현 시간:** 30-60분

---

### Option 2: Critical Path Preloading
**개요**: Dashboard + 인증만 upfront 로드, 나머지는 lazy load

**장점:**
- 즉시 첫 페이지 표시
- 자주 사용하는 경로는 빠름
- 전체 lazy loading보다 구현 쉬움

**단점:**
- 관리자 페이지는 첫 접근 시 여전히 지연
- 부분적 개선

**구현 시간:** 15-30분

---

### Option 3: Session State Caching
**개요**: 무거운 작업(DB 쿼리, 서비스 초기화)을 캐시

**장점:**
- 이후 로드가 빨라짐
- 리팩토링 불필요
- 구현 쉬움

**단점:**
- 첫 로드는 여전히 느림
- 메모리 사용량 증가

**구현 시간:** 15분

---

### Option 4: Database Initialization Optimization
**개요**: 세션마다가 아닌 컨테이너당 한 번만 DB 초기화

**장점:**
- 빠른 효과
- 단점 없음
- 체크 로직 이미 존재

**단점:**
- 페이지 import 오버헤드는 해결 안 됨
- import가 병목이면 효과 제한적

**구현 시간:** 5분

---

## 권장 접근 방식: Hybrid Approach

### Phase 1 (빠른 효과 - 20분)
1. ✅ DB 초기화 수정 (컨테이너당 1회만)
2. ✅ 관리자 전용 페이지만 lazy load
3. ✅ Dashboard + Attendance + News는 eager load 유지

**예상 효과:** 첫 로드 40-60% 빠름

### Phase 2 (필요시 - 40분)
4. 전체 lazy loading 구현
5. 서비스 레벨 캐싱

**예상 효과:** 첫 로드 70-80% 빠름

## 구현 우선순위

### 즉시 적용 가능 (5분)
- DB 초기화 최적화
- `check_database()` 함수 개선

### 단기 (20분)
- 관리자 페이지 lazy loading
- 핵심 페이지만 eager load

### 중기 (1시간)
- 전체 lazy loading 시스템
- 동적 import with `importlib`

## 다음 단계

**선택지:**
- A) Hybrid approach 즉시 구현 (빠른 효과)
- B) 전체 lazy loading 구현 (최대 성능)
- C) DB 초기화만 수정 (5분 fix)
- D) 모든 옵션의 코드 변경사항 먼저 확인

## 추가 고려사항

### 측정 가능한 지표
- 현재 첫 페이지 로드 시간: ?초
- 목표 로드 시간: ?초
- 사용자 경험 기준: 3초 이내 권장

### 사용 패턴 분석 필요
- 가장 많이 접근하는 페이지는?
- 관리자 vs 일반 사용자 비율은?
- 페이지 전환 빈도는?
