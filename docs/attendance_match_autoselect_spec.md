# 출석 페이지 자동 선택 개선 스펙

## 배경
- 대시보드 달력 또는 경기 목록에서 `📋 출석관리` 버튼을 누르면 출석 페이지로 이동한다.
- 현재 출석 페이지의 `경기 선택` 드롭다운은 항상 첫 번째 경기를 기본값으로 선택한다.
- 사용자는 방금 선택한 경기의 출석 현황을 보려고 이동했지만, 직접 드롭다운에서 다시 선택해야 하는 번거로움이 있다.

## 목표
- 다른 페이지에서 출석 페이지로 이동할 때, 직전에 선택한 경기 ID를 전달해 자동으로 같은 경기가 선택되도록 한다.
- 출석 페이지 내에서 사용자가 드롭다운을 변경하면 이후 이동에서도 변경된 값이 유지되도록 한다.
- 기존 기능(출석 통계, 개인별 출석 등)에 영향을 주지 않고 구현한다.

## 요구사항
1. **세션 상태 전달**
   - 달력 이벤트 클릭, 일정 관리 페이지의 `📋 출석 관리` 버튼 등 출석 페이지로 이동하는 모든 경로에서 선택한 `match_id`를 `st.session_state['selected_match_id']`에 저장한다.
   - 저장 시 정수형으로 변환하고, 변환에 실패하면 원래 값(문자열)을 유지한다.
2. **출석 페이지 초기 값 적용**
   - 출석 페이지 `경기별 출석` 탭의 `st.selectbox`가 렌더링될 때 `selected_match_id`가 존재하면 해당 경기로 기본 선택을 맞춘다.
   - `selected_match_id`가 목록에 없으면 기본값(첫 번째 항목)을 사용한다.
   - 사용자가 다른 경기를 선택하면 `selected_match_id`를 새 값으로 업데이트한다.
3. **안정성 확보**
   - `selected_match_id`에 해당하는 경기 정보가 존재하지 않는 경우(삭제/필터 등)에도 페이지가 오류 없이 렌더링되도록 기본값을 사용한다.
   - 필요 시 디버깅 메시지 대신 로깅 또는 사용자에게 자연스러운 안내 메시지를 사용한다.

## 예시 흐름
1. 대시보드 달력에서 A 경기 이벤트를 클릭한다.
2. 앱은 `st.session_state['selected_match_id'] = A`를 설정하고 출석 페이지로 이동한다.
3. 출석 페이지의 `경기 선택` 드롭다운이 A 경기로 초기화되어 바로 출석 현황을 확인할 수 있다.
4. 사용자가 드롭다운에서 B 경기를 선택하면 `selected_match_id`가 B로 갱신된다.
5. 이후 다른 페이지를 거쳐 다시 출석 페이지로 돌아와도 B 경기가 기본값으로 선택된다.

## 수용 조건
- 위 예시 흐름이 재현 가능할 것.
- `selected_match_id` 값이 잘못된 경우에도 앱이 정상 동작하며 기본값이 선택된다.
- 신규 세션(브라우저 새로고침 등)에서는 기존과 동일하게 첫 경기로 초기화된다.

## 구현 현황 (2025-10-15)
- `ui/pages/attendance.py`의 경기 선택/개인별 탭 드롭다운이 세션 인덱스 키(`match_select_dropdown`, `personal_match_select_{player_id}`)와 동기화된다.
- 다른 페이지에서 설정한 `selected_match_id`가 있으면 해당 경기로 기본값을 재설정하고, 사용자가 변경하면 세션 상태가 갱신된다.
- "다른 경기 보기" 버튼이 세션 키를 초기화해 새 선택을 강제할 수 있다.
